<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>gluxEngine: scene.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>scene.h</h1><a href="scene_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="preprocessor">#ifndef _SCENE_H_</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#define _SCENE_H_</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="globals_8h.html" title="common OpenGL and system includes, extern variables and enum types">globals.h</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="material_8h.html" title="material settings, dynamic shader creation">material.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="light_8h.html" title="light class and light settings">light.h</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="camera_8h.html" title="initialization and manipulating with camera - declarations">camera.h</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="shadow_8h.html" title="settings for shadows">shadow.h</a>&quot;</span>
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="scene_8h.html#a23edc160be5a8a6a40cc2a78f0483fed">00017</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="scene_8h.html#a23edc160be5a8a6a40cc2a78f0483fed">align</a> = <span class="keyword">sizeof</span>(glm::vec4);      <span class="comment">//BUG: ATI Catalyst 10.12 drivers align uniform block values to vec4</span>
<a name="l00018"></a>00018 
<a name="l00025"></a><a class="code" href="class_t_scene.html">00025</a> <span class="keyword">class </span><a class="code" href="class_t_scene.html" title="containts list of objects, inits and draws 3D scene. It has 3 main lists: objects...">TScene</a>
<a name="l00026"></a>00026 {
<a name="l00027"></a>00027 <span class="keyword">protected</span>:
<a name="l00029"></a><a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677">00029</a>     map&lt;string,TObject*&gt; <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>;
<a name="l00031"></a><a class="code" href="class_t_scene.html#a75e267aad9362dd9f5d37c63d2b79578">00031</a>     map&lt;string,TObject*&gt;::iterator <a class="code" href="class_t_scene.html#a75e267aad9362dd9f5d37c63d2b79578" title="iterator for objects container">m_io</a>;
<a name="l00033"></a><a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460">00033</a>     map&lt;string,TMaterial*&gt; <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>;
<a name="l00035"></a><a class="code" href="class_t_scene.html#a885f8ef950dcd78d47dd1d26eaac2f4c">00035</a>     map&lt;string,TMaterial*&gt;::iterator <a class="code" href="class_t_scene.html#a885f8ef950dcd78d47dd1d26eaac2f4c" title="iterator for materials container">m_im</a>;
<a name="l00037"></a><a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b">00037</a>     vector&lt;TLight*&gt; <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>;
<a name="l00039"></a><a class="code" href="class_t_scene.html#a1fa88c109d9d4753632f2b4c8ab9e1de">00039</a>     vector&lt;TLight*&gt;::iterator <a class="code" href="class_t_scene.html#a9216aee9d78760337667cce96f959341" title="iterator for lights container">m_il</a>, <a class="code" href="class_t_scene.html#a1fa88c109d9d4753632f2b4c8ab9e1de">m_il2</a>;
<a name="l00040"></a><a class="code" href="class_t_scene.html#a8ded9af1b75953a29095c70a973b30c9">00040</a>     <span class="keywordtype">int</span> <a class="code" href="class_t_scene.html#a8ded9af1b75953a29095c70a973b30c9">m_shadow_textures</a>;    <span class="comment">//count of shader textures</span>
<a name="l00041"></a>00041 
<a name="l00045"></a><a class="code" href="class_t_scene.html#adaf60097dc1cc3ea4db18a16bc2ada6f">00045</a>     map&lt;string,GLuint&gt; <a class="code" href="class_t_scene.html#adaf60097dc1cc3ea4db18a16bc2ada6f">m_tex_cache</a>;
<a name="l00047"></a><a class="code" href="class_t_scene.html#a17fc303b3d759625f942bb21b216c8bf">00047</a>     map&lt;string,GLuint&gt;::iterator <a class="code" href="class_t_scene.html#a17fc303b3d759625f942bb21b216c8bf" title="iterator for texture cache container">m_it</a>;
<a name="l00049"></a><a class="code" href="class_t_scene.html#a7274d34b8c29331efc76885aee052320">00049</a>     map&lt;string,VBO&gt; <a class="code" href="class_t_scene.html#a7274d34b8c29331efc76885aee052320" title="3DS objects cache - purpose is the same as texture cache">m_obj_cache</a>;
<a name="l00051"></a><a class="code" href="class_t_scene.html#ae23d1dffd9bd1b258bfde3a8abcc6efe">00051</a>     map&lt;string,VBO&gt;::iterator <a class="code" href="class_t_scene.html#ae23d1dffd9bd1b258bfde3a8abcc6efe" title="iterator for object cache container">m_iob</a>;
<a name="l00052"></a>00052 
<a name="l00054"></a><a class="code" href="class_t_scene.html#adb1eecd761c868bd2acf325d5e653b95">00054</a>     GLuint <a class="code" href="class_t_scene.html#adb1eecd761c868bd2acf325d5e653b95" title="uniform buffers">m_uniform_matrices</a>, <a class="code" href="class_t_scene.html#a95dfd7744e2d93f194ddd07546ff7563">m_uniform_lights</a>;
<a name="l00055"></a>00055 
<a name="l00057"></a><a class="code" href="class_t_scene.html#ab4bbb76155255fcb10cf7034738008ee">00057</a>     <a class="code" href="class_texture.html" title="holds texture parameters and contains functions to load texture from external file...">Texture</a> *<a class="code" href="class_t_scene.html#ab4bbb76155255fcb10cf7034738008ee" title="2D font texture">m_font2D_tex</a>;
<a name="l00059"></a><a class="code" href="class_t_scene.html#a7bf956f5de4b3abb3133ba14ce78484d">00059</a>     <a class="code" href="class_texture.html" title="holds texture parameters and contains functions to load texture from external file...">Texture</a> *<a class="code" href="class_t_scene.html#a7bf956f5de4b3abb3133ba14ce78484d" title="Background texture.">m_font2D_bkg</a>;
<a name="l00061"></a><a class="code" href="class_t_scene.html#a50252b1241661063a194e18184ab8f4a">00061</a>     GLuint <a class="code" href="class_t_scene.html#a50252b1241661063a194e18184ab8f4a" title="Display list for font.">m_font2D</a>;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063     <span class="comment">//scene parameters</span>
<a name="l00064"></a>00064 
<a name="l00066"></a><a class="code" href="class_t_scene.html#a3cd097f1e85a8d1d1e2a13e90e616342">00066</a>     GLint <a class="code" href="class_t_scene.html#a3f9117f3ae307e7d63a754ea10c33c46" title="screen resolution">m_resx</a>, <a class="code" href="class_t_scene.html#a3cd097f1e85a8d1d1e2a13e90e616342">m_resy</a>;
<a name="l00068"></a><a class="code" href="class_t_scene.html#a55b0f0b4dc47e0153611126c9367fd09">00068</a>     GLfloat <a class="code" href="class_t_scene.html#a55b0f0b4dc47e0153611126c9367fd09" title="clipping planes">m_near_p</a>, <a class="code" href="class_t_scene.html#aab2ffa49c0a293decf8b814a71a47907">m_far_p</a>;
<a name="l00070"></a><a class="code" href="class_t_scene.html#a924ae71c66e93359df167f49c652db47">00070</a>     GLfloat <a class="code" href="class_t_scene.html#a924ae71c66e93359df167f49c652db47" title="field of view">m_fovy</a>;
<a name="l00071"></a>00071 
<a name="l00073"></a><a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71">00073</a>     <a class="code" href="class_t_camera.html" title="scene camera class. Sets default scene camera, performs basic camera movements, pointing...">TCamera</a> *<a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>;
<a name="l00075"></a><a class="code" href="class_t_scene.html#a141f71a461cb13b34b552af75c189170">00075</a>     <span class="keywordtype">bool</span> <a class="code" href="class_t_scene.html#a141f71a461cb13b34b552af75c189170" title="do we use custom camera?">m_custom_cam</a>;
<a name="l00077"></a><a class="code" href="class_t_scene.html#a16746921c13ca3c19a629ba26b9c82e2">00077</a>     GLint <a class="code" href="class_t_scene.html#a16746921c13ca3c19a629ba26b9c82e2" title="number of multisaples in antialiasing">m_msamples</a>;
<a name="l00078"></a>00078 
<a name="l00080"></a><a class="code" href="class_t_scene.html#a5bd27ac7c16e392fdd369e55f2c553fb">00080</a>     glm::mat4 <a class="code" href="class_t_scene.html#a5bd27ac7c16e392fdd369e55f2c553fb" title="camera matrices">m_viewMatrix</a>, <a class="code" href="class_t_scene.html#af7f80c234d84eda9a5ad26c8011a50a1">m_projMatrix</a>;
<a name="l00081"></a>00081 
<a name="l00082"></a>00082     <span class="comment">//scene render to texture target (FBO) and progress bar</span>
<a name="l00083"></a><a class="code" href="class_t_scene.html#a71786e1181022b6299bd8a5eb4d59b97">00083</a>     GLuint <a class="code" href="class_t_scene.html#a0d0b8f349012ce76a08663d34ee26e3f">m_screen_quad</a>, <a class="code" href="class_t_scene.html#a6182efb57cb11723c112512bcfbe8407">m_small_quad</a>, <a class="code" href="class_t_scene.html#a71786e1181022b6299bd8a5eb4d59b97">m_small_quad_tex</a>, <a class="code" href="class_t_scene.html#a5233cb24fbdd4beac0446c43459db2aa">m_progress_bar</a>;
<a name="l00084"></a>00084 
<a name="l00086"></a><a class="code" href="class_t_scene.html#a258d8ec26e1850f49ff71a139c7c4216">00086</a>     <span class="keywordtype">bool</span> <a class="code" href="class_t_scene.html#ae29ca11435acf4c416278f409c2f0ca1" title="shall we use HDR, SSAO or shadows?">m_useHDR</a>, <a class="code" href="class_t_scene.html#a258d8ec26e1850f49ff71a139c7c4216">m_useSSAO</a>, <a class="code" href="class_t_scene.html#af9127a45537c1ae0dc61f055de145c15">m_useShadows</a>, <a class="code" href="class_t_scene.html#aee8df7b5db5f3fd21b55d97cfa6a4d7b">m_useNormalBuffer</a>;
<a name="l00088"></a><a class="code" href="class_t_scene.html#aec0a0206d0537da4545f378716f5b7ae">00088</a>     <span class="keywordtype">bool</span> <a class="code" href="class_t_scene.html#aec0a0206d0537da4545f378716f5b7ae" title="wireframe">m_wireframe</a>;
<a name="l00089"></a>00089 
<a name="l00091"></a><a class="code" href="class_t_scene.html#a8afb713f0e525070d8c362a4bc4c682e">00091</a>     GLuint <a class="code" href="class_t_scene.html#ae0b5f44b7dfcc3d90ab082561e440c4e" title="framebuffer/renderbuffer objects for color/depth">m_f_bufferAA</a>, <a class="code" href="class_t_scene.html#a494f77d7a4c2d74b3d826050a4bd085f">m_f_buffer_select</a>, <a class="code" href="class_t_scene.html#a8afb713f0e525070d8c362a4bc4c682e">m_r_bufferAA</a>;
<a name="l00092"></a>00092 
<a name="l00094"></a><a class="code" href="class_t_scene.html#a04fc38f0967a0a5c42d3f58275d5159e">00094</a>     GLint <a class="code" href="class_t_scene.html#a0c4578920be0b5874a5d39c6f3915089" title="render target sizes">m_RT_resX</a>, <a class="code" href="class_t_scene.html#a04fc38f0967a0a5c42d3f58275d5159e">m_RT_resY</a>;                         
<a name="l00095"></a>00095 
<a name="l00097"></a><a class="code" href="class_t_scene.html#a69bf78b35bdfb85e668ff2e858f730e6">00097</a>     <span class="keywordtype">int</span> <a class="code" href="class_t_scene.html#a69bf78b35bdfb85e668ff2e858f730e6" title="number of items to be loaded">m_load_list</a>, <a class="code" href="class_t_scene.html#aa9a87dfb913ec42b1b2da757ae811527">m_load_actual</a>;
<a name="l00098"></a>00098 
<a name="l00100"></a><a class="code" href="class_t_scene.html#a37b2b100c799fe4d6a0515720a3bd424">00100</a>     <span class="keywordtype">int</span> <a class="code" href="class_t_scene.html#a37b2b100c799fe4d6a0515720a3bd424" title="subscene ID - used when we need to hide some parts of the scene">m_sceneID</a>;
<a name="l00101"></a>00101 
<a name="l00103"></a><a class="code" href="class_t_scene.html#affaf1c7e73abcc89118c5a439d9e45dc">00103</a>     <span class="keywordtype">float</span> <a class="code" href="class_t_scene.html#affaf1c7e73abcc89118c5a439d9e45dc" title="settings for DPSM">m_dp_FOV</a>;
<a name="l00104"></a><a class="code" href="class_t_scene.html#a9ab2580ef20a987cc83ef6bc9b98565c">00104</a>     glm::vec3 <a class="code" href="class_t_scene.html#a9ab2580ef20a987cc83ef6bc9b98565c">m_parab_angle</a>;
<a name="l00105"></a><a class="code" href="class_t_scene.html#a29fe9fbe40be1e7b2db162ce403ad496">00105</a>     <span class="keywordtype">bool</span> <a class="code" href="class_t_scene.html#a52bc2e66d0e82e66d25d31e8ddd848fa">m_dpshadow_enhance</a>, <a class="code" href="class_t_scene.html#ac50966b27e0d12f04aa87feda3467f7c">m_dpshadow_tess</a>, <a class="code" href="class_t_scene.html#a29fe9fbe40be1e7b2db162ce403ad496">m_draw_shadow_map</a>;
<a name="l00106"></a><a class="code" href="class_t_scene.html#a211be84fab96711c45e5c959b448baf4">00106</a>     <span class="keywordtype">float</span> <a class="code" href="class_t_scene.html#a211be84fab96711c45e5c959b448baf4">m_min_depth</a>, <a class="code" href="class_t_scene.html#a9258935d6441e202e127c39aa773662f">m_avg_depth</a>, <a class="code" href="class_t_scene.html#a6981c6603cd6483524b4f7e64ac92c09">m_max_depth</a>;
<a name="l00107"></a><a class="code" href="class_t_scene.html#a875f1f2fbb09a035c12f0e6428e8cd65">00107</a>     glm::vec3 <a class="code" href="class_t_scene.html#a875f1f2fbb09a035c12f0e6428e8cd65">m_avg_normal</a>;
<a name="l00108"></a><a class="code" href="class_t_scene.html#a51aae62971e46b8ee022d459332c931e">00108</a>     <span class="keywordtype">float</span> *<a class="code" href="class_t_scene.html#a51aae62971e46b8ee022d459332c931e">m_select_buffer</a>;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="keyword">public</span>:
<a name="l00111"></a>00111     <span class="comment">//basic constructor</span>
<a name="l00112"></a>00112     <a class="code" href="class_t_scene.html#ac7ab271a9bc7c0e60008cd8c263a221e" title="Initialize scene by clearing lists.">TScene</a>();
<a name="l00113"></a>00113     <span class="comment">//free dynamic data</span>
<a name="l00114"></a>00114     <a class="code" href="class_t_scene.html#a7c99cefc8d5547a6dea9f83c0fc0f0ba" title="Destructor. Free dynamic data.">~TScene</a>();
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="comment">//scene initialization</span>
<a name="l00117"></a>00117     <span class="keywordtype">bool</span> <a class="code" href="class_t_scene.html#a05dd00f7adb8713d07f9a52125e6c6d6">PreInit</a>(GLint resx, GLint resy, GLfloat near, GLfloat far, GLfloat fovy, 
<a name="l00118"></a>00118                  GLint msamples, <span class="keywordtype">bool</span> cust_cam = <span class="keyword">false</span>, <span class="keywordtype">bool</span> load_font = <span class="keyword">true</span>);
<a name="l00119"></a>00119     <span class="keywordtype">bool</span> <a class="code" href="class_t_scene.html#a44f95ca6433650019e9ab3192c71fa28" title="Scene second initialization. The purpose of this initialization is to assign default...">PostInit</a>();
<a name="l00120"></a>00120     <span class="comment">//resize window</span>
<a name="l00121"></a>00121     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ae55c098c7f2436df8747ddef93515ca9" title="Resize screen to new dimensions, re-initialize viewport and projection matrices.">Resize</a>(GLint resx, GLint resy);
<a name="l00122"></a>00122     <span class="comment">//draw scene - setup, render targets and objects</span>
<a name="l00123"></a>00123     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a2adc55afb3059aee8dab5e5d2c7aa9a1" title="Render scene - camera, lights and objects(run through object list and call render...">Redraw</a>(<span class="keywordtype">bool</span> delete_buffer = <span class="keyword">true</span>);
<a name="l00124"></a>00124     <span class="comment">//draw all objects in scene</span>
<a name="l00125"></a>00125     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a6c9fd7fefe9b3e9ea18b96d023da7155" title="Draw all objects in scene. Drawing is done in material manner because shader switching...">DrawScene</a>(<span class="keywordtype">int</span> drawmode);
<a name="l00126"></a>00126     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a6cc4d5ef1276d2af64e1db7cc172a678" title="Draw all objects in scene. Only depth values are outputted (drawing into shadow map...">DrawSceneDepth</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* shadow_mat, glm::mat4&amp; lightMatrix);
<a name="l00127"></a>00127     <span class="comment">//draw load screen</span>
<a name="l00128"></a>00128     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#aa5321e9cba37eefedd77699d76bb8258" title="Draw loading screen.">LoadScreen</a>(<span class="keywordtype">bool</span> swap = <span class="keyword">true</span>);
<a name="l00129"></a>00129     <span class="comment">//destroy scene, free dynamic data</span>
<a name="l00130"></a>00130     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a4fa936eac5a962e76dc12ee4505bed61" title="Destroys all dynamic scene data, but keeps scene settings (like perspective, clipping...">Destroy</a>(<span class="keywordtype">bool</span> delete_cache = <span class="keyword">true</span>);
<a name="l00132"></a><a class="code" href="class_t_scene.html#a24db32a91c18526ff5832c588417d6a8">00132</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a24db32a91c18526ff5832c588417d6a8" title="set load items count (extern objects, textures and scenes)">SetLoadList</a>(<span class="keywordtype">int</span> count){ 
<a name="l00133"></a>00133         <a class="code" href="class_t_scene.html#a69bf78b35bdfb85e668ff2e858f730e6" title="number of items to be loaded">m_load_list</a> = count; <a class="code" href="class_t_scene.html#aa9a87dfb913ec42b1b2da757ae811527">m_load_actual</a> = count; 
<a name="l00134"></a>00134     }
<a name="l00136"></a><a class="code" href="class_t_scene.html#a7957d91e1ebed362c5188347e4c120e4">00136</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a7957d91e1ebed362c5188347e4c120e4" title="update load list (when loading scene)">UpdateLoadList</a>(<span class="keywordtype">int</span> count){  
<a name="l00137"></a>00137         <a class="code" href="class_t_scene.html#a69bf78b35bdfb85e668ff2e858f730e6" title="number of items to be loaded">m_load_list</a> += count; <a class="code" href="class_t_scene.html#aa9a87dfb913ec42b1b2da757ae811527">m_load_actual</a> += count; 
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <span class="comment">//load whole scene from 3DS file</span>
<a name="l00141"></a>00141     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a8377ae8e57278d48737de2b5c15a8d47" title="Loads entire scene from 3DS file.">LoadScene</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">bool</span> load_materials = <span class="keyword">true</span>, <span class="keywordtype">bool</span> load_lights = <span class="keyword">true</span>, <span class="keywordtype">string</span> name_space = <span class="stringliteral">&quot;&quot;</span>);
<a name="l00142"></a>00142 
<a name="l00144"></a><a class="code" href="class_t_scene.html#a47a763c444e0563e8247c75d0588e47e">00144</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a47a763c444e0563e8247c75d0588e47e" title="Change scene ID. All objects will from now belong to this ID. Only one sceneID section...">ChangeSceneID</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>){  
<a name="l00145"></a>00145         <a class="code" href="class_t_scene.html#a37b2b100c799fe4d6a0515720a3bd424" title="subscene ID - used when we need to hide some parts of the scene">m_sceneID</a> = id; 
<a name="l00146"></a>00146     }
<a name="l00147"></a>00147 
<a name="l00149"></a><a class="code" href="class_t_scene.html#a255ac20934bff005e2a8e49c66ad8d07">00149</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a255ac20934bff005e2a8e49c66ad8d07" title="Toggle wireframe rendering.">Wireframe</a>(<span class="keywordtype">bool</span> flag){  
<a name="l00150"></a>00150         <a class="code" href="class_t_scene.html#aec0a0206d0537da4545f378716f5b7ae" title="wireframe">m_wireframe</a> = flag; 
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152 
<a name="l00154"></a>00154 
<a name="l00156"></a><a class="code" href="class_t_scene.html#a4315c4a4dfc61a59cbebb37e74d7d885">00156</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a4315c4a4dfc61a59cbebb37e74d7d885" title="Update new camera position and modelview matrix(for lights) in uniform buffer.">UpdateCameraUniform</a>(){
<a name="l00157"></a>00157         glBindBuffer(GL_UNIFORM_BUFFER, <a class="code" href="class_t_scene.html#a95dfd7744e2d93f194ddd07546ff7563">m_uniform_lights</a>);
<a name="l00158"></a>00158         <span class="comment">//glBufferSubData(GL_UNIFORM_BUFFER, lights.size()*5*align, sizeof(glm::vec3), glm::value_ptr(cam.GetPos())); </span>
<a name="l00159"></a>00159         <span class="keywordtype">int</span> i; <span class="comment">//update light positions with new modelview matrix</span>
<a name="l00160"></a>00160         <span class="keywordflow">for</span>(i = 0, <a class="code" href="class_t_scene.html#a9216aee9d78760337667cce96f959341" title="iterator for lights container">m_il</a> = <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>.begin(); <a class="code" href="class_t_scene.html#a9216aee9d78760337667cce96f959341" title="iterator for lights container">m_il</a> != <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>.end(); ++<a class="code" href="class_t_scene.html#a9216aee9d78760337667cce96f959341" title="iterator for lights container">m_il</a>, ++i)
<a name="l00161"></a>00161             glBufferSubData( GL_UNIFORM_BUFFER, i*<a class="code" href="scene_8h.html#a23edc160be5a8a6a40cc2a78f0483fed">align</a>, <span class="keyword">sizeof</span>(glm::vec3), 
<a name="l00162"></a>00162                              glm::value_ptr(glm::vec3(<a class="code" href="class_t_scene.html#a5bd27ac7c16e392fdd369e55f2c553fb" title="camera matrices">m_viewMatrix</a> * glm::vec4((*m_il)-&gt;GetPos(), 1.0))) );
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164 
<a name="l00166"></a><a class="code" href="class_t_scene.html#a2a3ffbc1b0f30b4dfb878bf4530cb5f4">00166</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a2a3ffbc1b0f30b4dfb878bf4530cb5f4" title="Move camera to new position(relative).">MoveCamera</a>(GLfloat wx, GLfloat wy, GLfloat wz){ 
<a name="l00167"></a>00167         <a class="code" href="class_t_scene.html#a5bd27ac7c16e392fdd369e55f2c553fb" title="camera matrices">m_viewMatrix</a> = <a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#aa2815c901957dc7025051cf547c44706" title="Move camera to new position(relative).">Move</a>(wx,wy,wz);
<a name="l00168"></a>00168         <a class="code" href="class_t_scene.html#a4315c4a4dfc61a59cbebb37e74d7d885" title="Update new camera position and modelview matrix(for lights) in uniform buffer.">UpdateCameraUniform</a>();
<a name="l00169"></a>00169     }
<a name="l00171"></a><a class="code" href="class_t_scene.html#aafe440f65b3958569f5de1cfbfec58f8">00171</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#aafe440f65b3958569f5de1cfbfec58f8" title="Move camera to new position(absolute).">MoveCameraAbs</a>(GLfloat wx, GLfloat wy, GLfloat wz){ 
<a name="l00172"></a>00172         <a class="code" href="class_t_scene.html#a5bd27ac7c16e392fdd369e55f2c553fb" title="camera matrices">m_viewMatrix</a> = <a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#abc5a1258d05830f56af394eaa73dc378" title="Move camera to new position(absolute).">MoveAbs</a>(wx,wy,wz); 
<a name="l00173"></a>00173         <a class="code" href="class_t_scene.html#a4315c4a4dfc61a59cbebb37e74d7d885" title="Update new camera position and modelview matrix(for lights) in uniform buffer.">UpdateCameraUniform</a>();
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175 
<a name="l00177"></a><a class="code" href="class_t_scene.html#abcbb99bf31b8b6b0eb0dec6b96bcb018">00177</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#abcbb99bf31b8b6b0eb0dec6b96bcb018" title="Camera look.">LookCameraAt</a>(GLfloat wx, GLfloat wy, GLfloat wz){
<a name="l00178"></a>00178         <a class="code" href="class_t_scene.html#a5bd27ac7c16e392fdd369e55f2c553fb" title="camera matrices">m_viewMatrix</a> = <a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#aad1e764173b3529e010ddf92d64e4291" title="Look camera at target.">LookAt</a>(wx,wy,wz); 
<a name="l00179"></a>00179         <a class="code" href="class_t_scene.html#a4315c4a4dfc61a59cbebb37e74d7d885" title="Update new camera position and modelview matrix(for lights) in uniform buffer.">UpdateCameraUniform</a>();
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181 
<a name="l00183"></a><a class="code" href="class_t_scene.html#ad786274cb0457b7108489a52e11fa910">00183</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ad786274cb0457b7108489a52e11fa910" title="Rotate camera around axis(A_X, A_Y or A_Z) by angle(relative).">RotateCamera</a>(GLfloat angle, GLint axis){ 
<a name="l00184"></a>00184         <a class="code" href="class_t_scene.html#a5bd27ac7c16e392fdd369e55f2c553fb" title="camera matrices">m_viewMatrix</a> =  <a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#ab7d70906ededaa3afcf3c579b09c2749" title="Rotate camera around axis(relative).">Rotate</a>(angle,axis);
<a name="l00185"></a>00185         <a class="code" href="class_t_scene.html#a4315c4a4dfc61a59cbebb37e74d7d885" title="Update new camera position and modelview matrix(for lights) in uniform buffer.">UpdateCameraUniform</a>();
<a name="l00186"></a>00186     }
<a name="l00188"></a><a class="code" href="class_t_scene.html#a6931a1ec7173f1c10e1978687caec13f">00188</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a6931a1ec7173f1c10e1978687caec13f" title="Rotate camera around axis(A_X, A_Y or A_Z) by angle(absolute).">RotateCameraAbs</a>(GLfloat angle, GLint axis){ 
<a name="l00189"></a>00189         <a class="code" href="class_t_scene.html#a5bd27ac7c16e392fdd369e55f2c553fb" title="camera matrices">m_viewMatrix</a> =  <a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#adbda4fdf25476bff49833124a710500e" title="Rotate camera around axis(absolute).">RotateAbs</a>(angle,axis); 
<a name="l00190"></a>00190         <a class="code" href="class_t_scene.html#a4315c4a4dfc61a59cbebb37e74d7d885" title="Update new camera position and modelview matrix(for lights) in uniform buffer.">UpdateCameraUniform</a>();
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192 
<a name="l00194"></a><a class="code" href="class_t_scene.html#a8aedd5441fdea0953f3716ac509ef90c">00194</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a8aedd5441fdea0953f3716ac509ef90c" title="Switch between custom and scene camera.">SwitchCamera</a>(){ 
<a name="l00195"></a>00195         <a class="code" href="class_t_scene.html#a141f71a461cb13b34b552af75c189170" title="do we use custom camera?">m_custom_cam</a> = !<a class="code" href="class_t_scene.html#a141f71a461cb13b34b552af75c189170" title="do we use custom camera?">m_custom_cam</a>; 
<a name="l00196"></a>00196     }
<a name="l00197"></a>00197 
<a name="l00199"></a><a class="code" href="class_t_scene.html#a04eaab8aa36cffda018d6e0788ce9612">00199</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a04eaab8aa36cffda018d6e0788ce9612" title="Print out camera position.">PrintCamera</a>(){ 
<a name="l00200"></a>00200         cout&lt;&lt;<span class="stringliteral">&quot;POS: &quot;</span>&lt;&lt;<a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#af44449f1efd71459efd7167620e18a36" title="get camera position">GetPos</a>().x&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;<a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#af44449f1efd71459efd7167620e18a36" title="get camera position">GetPos</a>().y&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;<a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#af44449f1efd71459efd7167620e18a36" title="get camera position">GetPos</a>().z&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>
<a name="l00201"></a>00201             &lt;&lt;<span class="stringliteral">&quot;ROT: &quot;</span>&lt;&lt;<a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#a5e1030de0a8607e428a962a7c32b1312" title="get camera rotation">GetRot</a>().x&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;<a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#a5e1030de0a8607e428a962a7c32b1312" title="get camera rotation">GetRot</a>().y&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;<a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#a5e1030de0a8607e428a962a7c32b1312" title="get camera rotation">GetRot</a>().z&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; 
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203 
<a name="l00205"></a><a class="code" href="class_t_scene.html#afff79f0c89fa9e6b55d4fa66b4dc91a6">00205</a>     glm::vec3 <a class="code" href="class_t_scene.html#afff79f0c89fa9e6b55d4fa66b4dc91a6" title="Get screen-space camera position.">GetCameraPos</a>(){ 
<a name="l00206"></a>00206         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#af44449f1efd71459efd7167620e18a36" title="get camera position">GetPos</a>(); 
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208 
<a name="l00210"></a><a class="code" href="class_t_scene.html#a4ff25cbf5896b7f6e978fded97b5aafe">00210</a>     glm::vec3 <a class="code" href="class_t_scene.html#a4ff25cbf5896b7f6e978fded97b5aafe" title="Get camera rotation.">GetCameraRot</a>(){ 
<a name="l00211"></a>00211         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#a5e1030de0a8607e428a962a7c32b1312" title="get camera rotation">GetRot</a>();
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213 
<a name="l00215"></a><a class="code" href="class_t_scene.html#a76316b23a1f215b71f1e3f322d723ae0">00215</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a76316b23a1f215b71f1e3f322d723ae0" title="Change camera type.">SetCamType</a>(<span class="keywordtype">int</span> type){
<a name="l00216"></a>00216         <a class="code" href="class_t_scene.html#a8f44470367de6c059df9661300fa7f71" title="scene camera">m_cam</a>-&gt;<a class="code" href="class_t_camera.html#a8eaa23b0ff8f993dae1af27df403da09" title="Set camera type.">SetType</a>(type);
<a name="l00217"></a>00217     }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a1f7090e5931cc5bbe3f1e371a39c4b73" title="Add new light object. New light is pushed to the end of the list.">AddLight</a>(GLint _lights, glm::vec3 amb, glm::vec3 diff, glm::vec3 spec, glm::vec3 lpos, GLfloat radius = 1000.0);
<a name="l00223"></a>00223 
<a name="l00226"></a><a class="code" href="class_t_scene.html#acc92c066e2f9dc06aa7ddc913cde2e34">00226</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#acc92c066e2f9dc06aa7ddc913cde2e34" title="Remove light identified by number.">RemoveLight</a>(<span class="comment">/*int lightnum*/</span>){ 
<a name="l00227"></a>00227         <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>.clear(); 
<a name="l00228"></a>00228     }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a434648f5cf6ec88a9b92aebe89f7e1b2" title="Move light identified by number to new absolute position.">MoveLight</a>(GLint light, glm::vec3 w);
<a name="l00231"></a>00231     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ac9c8aada91585fe3282041c12708923b" title="Change color of light(identified by index).">ChangeLightColor</a>(GLint light, GLint component, glm::vec3 color);
<a name="l00232"></a>00232 
<a name="l00234"></a><a class="code" href="class_t_scene.html#a63991b0d1511d10ddf234e2ae2a7722b">00234</a>     <span class="keywordtype">int</span> <a class="code" href="class_t_scene.html#a63991b0d1511d10ddf234e2ae2a7722b" title="Return number of lights in scene.">GetLightCount</a>(){ 
<a name="l00235"></a>00235         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>.size(); 
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237 
<a name="l00239"></a><a class="code" href="class_t_scene.html#a0a8dfce7a80d6f8283c91213c5f9691c">00239</a>     glm::vec3 <a class="code" href="class_t_scene.html#a0a8dfce7a80d6f8283c91213c5f9691c" title="Return light position.">GetLightPos</a>(<span class="keywordtype">int</span> light){
<a name="l00240"></a>00240         <span class="keywordflow">if</span>(light &lt; 0 || (<span class="keywordtype">unsigned</span>)light &gt;= <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>.size()) { cerr&lt;&lt;<span class="stringliteral">&quot;WARNING: no light with index &quot;</span>&lt;&lt;light&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; <span class="keywordflow">return</span> glm::vec3(0.0); }
<a name="l00241"></a>00241         <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>[light]-&gt;GetPos();
<a name="l00242"></a>00242     }
<a name="l00243"></a>00243 
<a name="l00245"></a><a class="code" href="class_t_scene.html#af76908de9cb7cb937c68d92f834c3a18">00245</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#af76908de9cb7cb937c68d92f834c3a18" title="set light radius">SetLightRadius</a>(<span class="keywordtype">int</span> light, GLfloat radius){
<a name="l00246"></a>00246         <span class="keywordflow">if</span>(light &lt; 0 || (<span class="keywordtype">unsigned</span>)light &gt;= <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>.size()) 
<a name="l00247"></a>00247             cerr&lt;&lt;<span class="stringliteral">&quot;WARNING: no light with index &quot;</span>&lt;&lt;light&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00248"></a>00248         <span class="keywordflow">else</span> {
<a name="l00249"></a>00249             <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>[light]-&gt;SetRadius(radius);
<a name="l00250"></a>00250             <span class="comment">//update uniform buffer</span>
<a name="l00251"></a>00251             glBindBuffer(GL_UNIFORM_BUFFER, <a class="code" href="class_t_scene.html#a95dfd7744e2d93f194ddd07546ff7563">m_uniform_lights</a>);
<a name="l00252"></a>00252             glBufferSubData(GL_UNIFORM_BUFFER, <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>.size()*4*<a class="code" href="scene_8h.html#a23edc160be5a8a6a40cc2a78f0483fed">align</a> + light*<a class="code" href="scene_8h.html#a23edc160be5a8a6a40cc2a78f0483fed">align</a>, <span class="keyword">sizeof</span>(float), &amp;radius); 
<a name="l00253"></a>00253         }
<a name="l00254"></a>00254     }
<a name="l00255"></a>00255 
<a name="l00257"></a>00257 
<a name="l00259"></a><a class="code" href="class_t_scene.html#a2d1ffd6671133a5c9c26dd673fc6dd2c">00259</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a2d1ffd6671133a5c9c26dd673fc6dd2c" title="Add new object (see TObject() into list. Index is object name.">AddObject</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, <span class="keywordtype">int</span> primitive, GLfloat size = 0.0, GLfloat height = 0.0, GLint sliceX = 1, GLint sliceY = 1){
<a name="l00260"></a>00260         <a class="code" href="class_t_object.html" title="contains object information(unique name, type), 3D data(vertices, faces, normal and...">TObject</a> *o = <span class="keyword">new</span> <a class="code" href="class_t_object.html" title="contains object information(unique name, type), 3D data(vertices, faces, normal and...">TObject</a>(name, primitive, size, height, sliceX, sliceY);
<a name="l00261"></a>00261         <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[name] = o;
<a name="l00262"></a>00262         <a class="code" href="class_t_scene.html#aa5321e9cba37eefedd77699d76bb8258" title="Draw loading screen.">LoadScreen</a>(); <span class="comment">//update loading screen</span>
<a name="l00263"></a>00263         <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[name]-&gt;SetSceneID(<a class="code" href="class_t_scene.html#a37b2b100c799fe4d6a0515720a3bd424" title="subscene ID - used when we need to hide some parts of the scene">m_sceneID</a>);
<a name="l00264"></a>00264     }
<a name="l00266"></a><a class="code" href="class_t_scene.html#a749a94b1cae8e07b5cc943944f89d809">00266</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a749a94b1cae8e07b5cc943944f89d809" title="add new object as instance from existing object">AddObjectInstance</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *ref_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *inst_name){
<a name="l00267"></a>00267         <span class="keywordflow">if</span>(<a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>.find(ref_name) == <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>.end()) 
<a name="l00268"></a>00268             cerr&lt;&lt;<span class="stringliteral">&quot;WARNING (AddObjectInstance): no reference object with name &quot;</span>&lt;&lt;ref_name&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00269"></a>00269         <span class="keywordflow">else</span>{
<a name="l00270"></a>00270             <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[inst_name]-&gt;CreateInstance(*<a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[ref_name]);
<a name="l00271"></a>00271             <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[inst_name]-&gt;SetSceneID(<a class="code" href="class_t_scene.html#a37b2b100c799fe4d6a0515720a3bd424" title="subscene ID - used when we need to hide some parts of the scene">m_sceneID</a>);
<a name="l00272"></a>00272         }
<a name="l00273"></a>00273     }
<a name="l00274"></a>00274     <span class="comment">//add new object from external file</span>
<a name="l00275"></a>00275     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a2d1ffd6671133a5c9c26dd673fc6dd2c" title="Add new object (see TObject() into list. Index is object name.">AddObject</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* file);
<a name="l00276"></a>00276 
<a name="l00278"></a><a class="code" href="class_t_scene.html#a57259e5ad4bebb12889abce7ec156632">00278</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a57259e5ad4bebb12889abce7ec156632" title="Move object identified by name to new position(relative) (see TObject::Move() ).">MoveObj</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, GLfloat wx, GLfloat wy, GLfloat wz){ 
<a name="l00279"></a>00279         <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[name]-&gt;Move(wx,wy,wz); 
<a name="l00280"></a>00280     }
<a name="l00282"></a><a class="code" href="class_t_scene.html#ae1ac5a0feaa0545ddc00f820ba53ee35">00282</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ae1ac5a0feaa0545ddc00f820ba53ee35" title="Move object identified by name to new position(absolute) (see TObject::MoveAbs()...">MoveObjAbs</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, GLfloat wx, GLfloat wy, GLfloat wz){ 
<a name="l00283"></a>00283         <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[name]-&gt;MoveAbs(wx,wy,wz); 
<a name="l00284"></a>00284     }
<a name="l00285"></a>00285 
<a name="l00288"></a><a class="code" href="class_t_scene.html#a3a3e73d6051568e74d077f76803a90d8">00288</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a3a3e73d6051568e74d077f76803a90d8" title="Rotate object identified by name around axis(can be A_X, A_Y, A_Z) by angle(relative)...">RotateObj</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, GLfloat angle, GLint axis){ 
<a name="l00289"></a>00289         <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[name]-&gt;Rotate(angle,axis); 
<a name="l00290"></a>00290     }
<a name="l00293"></a><a class="code" href="class_t_scene.html#ac2a44ebf1674e79621b6f40207607586">00293</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ac2a44ebf1674e79621b6f40207607586" title="Rotate object identified by name around axis(can be A_X, A_Y, A_Z) by angle(absolute)...">RotateObjAbs</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, GLfloat angle, GLint axis){ 
<a name="l00294"></a>00294         <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[name]-&gt;RotateAbs(angle,axis); 
<a name="l00295"></a>00295     }
<a name="l00296"></a>00296 
<a name="l00298"></a><a class="code" href="class_t_scene.html#ac6a5d5c7ea04b3e7f6e6ab49b0547ee0">00298</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ac6a5d5c7ea04b3e7f6e6ab49b0547ee0" title="Resize object identified by name according to resize factor.">ResizeObj</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, GLfloat sx, GLfloat sy, GLfloat sz){ 
<a name="l00299"></a>00299         <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[name]-&gt;Resize(sx,sy,sz); 
<a name="l00300"></a>00300     }
<a name="l00302"></a><a class="code" href="class_t_scene.html#a815c34b0a4ae730f3d96fa2cd0a558e7">00302</a>     GLint <a class="code" href="class_t_scene.html#a815c34b0a4ae730f3d96fa2cd0a558e7" title="Return object&amp;#39;s vertex buffer ID.">GetVertexBuffer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>){
<a name="l00303"></a>00303         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[name]-&gt;GetVertexBuffer(); 
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306 
<a name="l00308"></a><a class="code" href="class_t_scene.html#a804d804c4e6211ed76f39bd5206867ef">00308</a>     glm::vec3 <a class="code" href="class_t_scene.html#a804d804c4e6211ed76f39bd5206867ef" title="Get object position.">GetObjPosition</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>){
<a name="l00309"></a>00309         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[name]-&gt;GetPosition(); 
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311 
<a name="l00313"></a><a class="code" href="class_t_scene.html#acd99336fd53df3963ae04246514987b9">00313</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#acd99336fd53df3963ae04246514987b9" title="toggle object drawing">DrawObject</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* obj_name, <span class="keywordtype">bool</span> flag){
<a name="l00314"></a>00314         <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[obj_name]-&gt;DrawObject(flag); 
<a name="l00315"></a>00315     }
<a name="l00316"></a>00316 
<a name="l00318"></a><a class="code" href="class_t_scene.html#a7ee4b37fa5e9006b216ab4989ce30770">00318</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a7ee4b37fa5e9006b216ab4989ce30770" title="Set count of object instances.">SetGInstances</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* obj_name, <span class="keywordtype">int</span> count){ 
<a name="l00319"></a>00319         <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[obj_name]-&gt;SetGInstances(count); 
<a name="l00320"></a>00320     }
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 
<a name="l00325"></a>00325 
<a name="l00327"></a><a class="code" href="class_t_scene.html#a1f5530c33e934dc2a7a516adab33d269">00327</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a1f5530c33e934dc2a7a516adab33d269" title="Add new material(see TMaterial()) to list.">AddMaterial</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, glm::vec3 amb = <a class="code" href="material_8h.html#ae6da9131b1d5241d9158c5c18dd0cbc0" title="black color">black</a>, glm::vec3 diff = <a class="code" href="material_8h.html#a44213650f86751562686ec84c6da7de3" title="silver color">silver</a>, glm::vec3 spec = <a class="code" href="material_8h.html#a169f6cb74499519355635c82a73ffd03" title="white color">white</a>,
<a name="l00328"></a>00328         GLfloat shin = 64.0, GLfloat reflect = 0.0, GLfloat transp = 0.0, GLint lm = <a class="code" href="globals_8h.html#ac7d59eb7ec62845443005f77b4077a90ab105fa30ed5e94117ebf6a37008f5e49">PHONG</a>){
<a name="l00329"></a>00329             <a class="code" href="class_t_material.html" title="hold all material properties necessary to create dynamic shader - light models textures...">TMaterial</a> *m = <span class="keyword">new</span> <a class="code" href="class_t_material.html" title="hold all material properties necessary to create dynamic shader - light models textures...">TMaterial</a>(name, <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.size(), amb, diff, spec, shin, reflect, transp, lm);
<a name="l00330"></a>00330             <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>[name] = m;
<a name="l00331"></a>00331             m_materials[name]-&gt;<a class="code" href="class_t_material.html#a607c2ed4106d341480a63eca4c8fbf83" title="Set scene ID.">SetSceneID</a>(<a class="code" href="class_t_scene.html#a37b2b100c799fe4d6a0515720a3bd424" title="subscene ID - used when we need to hide some parts of the scene">m_sceneID</a>);
<a name="l00332"></a>00332             <a class="code" href="class_t_scene.html#aa5321e9cba37eefedd77699d76bb8258" title="Draw loading screen.">LoadScreen</a>(); <span class="comment">//update loading screen</span>
<a name="l00333"></a>00333     }
<a name="l00334"></a>00334     <span class="comment">//add texture</span>
<a name="l00335"></a>00335     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a4fff95d9f85d4df6d3ede4817d3f7d39" title="Add texture to scene. If texture has been loaded, a texture pointer from cache is...">AddTexture</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *file, GLint textype = <a class="code" href="globals_8h.html#ac3601c766e904acff2b729f45ccba47caa7d623548e49a1514076f5bee3b314a4">BASE</a>, GLint texmode = <a class="code" href="globals_8h.html#a58ccca7526d1ef68034353cfb6bff879a17fe14cf4a1d6acfec73bac58c1d9951">MODULATE</a>,
<a name="l00336"></a>00336         GLfloat intensity = 1.0, GLfloat tileX = 1.0, GLfloat tileY = 1.0, <span class="keywordtype">bool</span> mipmap = <span class="keyword">true</span>, <span class="keywordtype">bool</span> aniso = <span class="keyword">false</span>);
<a name="l00337"></a>00337 
<a name="l00338"></a>00338     <span class="comment">//add cubemap</span>
<a name="l00339"></a>00339     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a4fff95d9f85d4df6d3ede4817d3f7d39" title="Add texture to scene. If texture has been loaded, a texture pointer from cache is...">AddTexture</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> **files, GLint textype = <a class="code" href="globals_8h.html#ac3601c766e904acff2b729f45ccba47ca422ce1ca9a3a89e4afb4aea745e329ce">CUBEMAP</a>, GLint texmode = <a class="code" href="globals_8h.html#a58ccca7526d1ef68034353cfb6bff879a17fe14cf4a1d6acfec73bac58c1d9951">MODULATE</a>,
<a name="l00340"></a>00340         GLfloat intensity = 1.0, GLfloat tileX = 1.0, GLfloat tileY = 1.0, <span class="keywordtype">bool</span> aniso = <span class="keyword">false</span>);
<a name="l00341"></a>00341 
<a name="l00342"></a>00342     <span class="comment">//bind material to object</span>
<a name="l00343"></a>00343     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a7eb928ab9949ef00d5fe43bae49d993e" title="Bind material(identified by mat_name) to object(identified by obj_name).">SetMaterial</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* obj_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *mat_name);
<a name="l00345"></a><a class="code" href="class_t_scene.html#ab9e40efe2eb2948d8ad95eb67425c13a">00345</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ab9e40efe2eb2948d8ad95eb67425c13a" title="Set material transparency.">SetTransparency</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* mat_name, GLfloat value){
<a name="l00346"></a>00346         <span class="keywordflow">if</span>(<a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.find(mat_name) == <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.end())
<a name="l00347"></a>00347             cerr&lt;&lt;<span class="stringliteral">&quot;WARNING (SetTransparency): no material with name &quot;</span>&lt;&lt;mat_name&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00348"></a>00348         <span class="keywordflow">else</span>
<a name="l00349"></a>00349             <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>[mat_name]-&gt;SetTransparency(value);
<a name="l00350"></a>00350     }
<a name="l00351"></a>00351 
<a name="l00354"></a><a class="code" href="class_t_scene.html#aafcc79bc72112714aeb644e6253896d5">00354</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#aafcc79bc72112714aeb644e6253896d5" title="Load custom shader from file. Shader can be then applied to any material (see TMaterial::CustomShade...">CustomShader</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* vert_source, <span class="keyword">const</span> <span class="keywordtype">char</span>* frag_source, 
<a name="l00355"></a>00355                       <span class="keyword">const</span> <span class="keywordtype">char</span> *vert_defines = <span class="stringliteral">&quot; &quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *frag_defines = <span class="stringliteral">&quot; &quot;</span>){
<a name="l00356"></a>00356         <span class="keywordflow">if</span>(<a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.find(name) == <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.end())
<a name="l00357"></a>00357             cerr&lt;&lt;<span class="stringliteral">&quot;WARNING (CustomShader): no material with name &quot;</span>&lt;&lt;name&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00358"></a>00358         <span class="keywordflow">else</span>
<a name="l00359"></a>00359             <span class="keywordflow">if</span>(!<a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>[name]-&gt;<a class="code" href="class_t_scene.html#aafcc79bc72112714aeb644e6253896d5" title="Load custom shader from file. Shader can be then applied to any material (see TMaterial::CustomShade...">CustomShader</a>(vert_source, frag_source, vert_defines, frag_defines))
<a name="l00360"></a>00360                 <span class="keywordflow">throw</span> <a class="code" href="globals_8h.html#aaf211b08d0e612635ba8b78049f5b7b4" title="Error code.">ERR</a>;
<a name="l00361"></a>00361     }
<a name="l00364"></a><a class="code" href="class_t_scene.html#a88e77d6f1725e7c45af122ed3923eb88">00364</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a88e77d6f1725e7c45af122ed3923eb88" title="Load custom shader from file. Shader can be then applied to any material (see TMaterial::CustomShade...">CustomShader</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, <a class="code" href="struct_t_shader.html" title="structure for shader properties">TShader</a> *vertex, <a class="code" href="struct_t_shader.html" title="structure for shader properties">TShader</a> *tess_control, <a class="code" href="struct_t_shader.html" title="structure for shader properties">TShader</a> *tess_eval, <a class="code" href="struct_t_shader.html" title="structure for shader properties">TShader</a> *geometry, <a class="code" href="struct_t_shader.html" title="structure for shader properties">TShader</a> *fragment){
<a name="l00365"></a>00365         <span class="keywordflow">if</span>(<a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.find(name) == <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.end())
<a name="l00366"></a>00366             cerr&lt;&lt;<span class="stringliteral">&quot;WARNING (CustomShader): no material with name &quot;</span>&lt;&lt;name&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00367"></a>00367         <span class="keywordflow">else</span>
<a name="l00368"></a>00368             <span class="keywordflow">if</span>(!<a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>[name]-&gt;<a class="code" href="class_t_scene.html#aafcc79bc72112714aeb644e6253896d5" title="Load custom shader from file. Shader can be then applied to any material (see TMaterial::CustomShade...">CustomShader</a>(vertex, tess_control, tess_eval,geometry, fragment))
<a name="l00369"></a>00369                 <span class="keywordflow">throw</span> <a class="code" href="globals_8h.html#aaf211b08d0e612635ba8b78049f5b7b4" title="Error code.">ERR</a>;
<a name="l00370"></a>00370     }
<a name="l00371"></a>00371 
<a name="l00373"></a>00373     <span class="keyword">template</span>&lt;<span class="keyword">class</span> UNIFORM&gt;
<a name="l00374"></a><a class="code" href="class_t_scene.html#ad22d410e56adf4ee25bd0e74c95ba9ad">00374</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ad22d410e56adf4ee25bd0e74c95ba9ad" title="Set uniform variable in material shader (see TMaterial::SetUniform() ).">SetUniform</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* m_name, <span class="keyword">const</span> <span class="keywordtype">char</span>* v_name, UNIFORM value){ 
<a name="l00375"></a>00375         <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>[m_name]-&gt;SetUniform(v_name, value); 
<a name="l00376"></a>00376     }
<a name="l00377"></a>00377 
<a name="l00379"></a><a class="code" href="class_t_scene.html#af765d2065d2e6dcd7ab29f6cdf103672">00379</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#af765d2065d2e6dcd7ab29f6cdf103672" title="Force regeneration of all materials.">BakeAllMaterials</a>(){ 
<a name="l00380"></a>00380         <span class="keywordflow">for</span>(<a class="code" href="class_t_scene.html#a885f8ef950dcd78d47dd1d26eaac2f4c" title="iterator for materials container">m_im</a> = <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.begin(); <a class="code" href="class_t_scene.html#a885f8ef950dcd78d47dd1d26eaac2f4c" title="iterator for materials container">m_im</a> != <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.end(); ++<a class="code" href="class_t_scene.html#a885f8ef950dcd78d47dd1d26eaac2f4c" title="iterator for materials container">m_im</a>)
<a name="l00381"></a>00381             <a class="code" href="class_t_scene.html#a885f8ef950dcd78d47dd1d26eaac2f4c" title="iterator for materials container">m_im</a>-&gt;second-&gt;BakeMaterial(<a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>.size()); 
<a name="l00382"></a>00382     }
<a name="l00383"></a>00383 
<a name="l00385"></a><a class="code" href="class_t_scene.html#a45d17d2a63f3a0eb37b3c05d71127aa6">00385</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a45d17d2a63f3a0eb37b3c05d71127aa6" title="Set material color.">SetMaterialColor</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, <span class="keywordtype">int</span> component, glm::vec3 color){
<a name="l00386"></a>00386         <span class="keywordflow">if</span>(<a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.find(name) == <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.end())
<a name="l00387"></a>00387             cerr&lt;&lt;<span class="stringliteral">&quot;WARNING (SetMaterialColor): no material with name &quot;</span>&lt;&lt;name&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00388"></a>00388         <span class="keywordflow">else</span>
<a name="l00389"></a>00389             <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>[name]-&gt;SetColor(component, color);
<a name="l00390"></a>00390     }
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 
<a name="l00393"></a>00393 
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <span class="comment">//create shadow map for selected light</span>
<a name="l00397"></a>00397     <span class="keywordtype">bool</span> <a class="code" href="class_t_scene.html#aa28c3d2e5f57f40c050a06dfda3176e1" title="Creates shadow map for selected light. Shadow map parameters are stored in TLight...">CreateShadowMap</a>(vector&lt;TLight*&gt;::iterator ii);
<a name="l00398"></a>00398     <span class="comment">//render shadow map (spot)</span>
<a name="l00399"></a>00399     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a749e343cf364930e78d3a24a74b595ec" title="Draws scene to shadow map (for spotlight).">RenderShadowMap</a>(<a class="code" href="class_t_light.html" title="contains light preferences like color,position,shadow...">TLight</a> *l);
<a name="l00400"></a>00400     <span class="comment">//render shadow map (omnidirectional, dual-paraboloid)</span>
<a name="l00401"></a>00401     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ada7b18bf99fdbf24456bec22e4b5216e" title="Draws scene to shadow map with dual-paraboloid mapping (for omnidirectional light)...">RenderShadowMapOmni</a>(<a class="code" href="class_t_light.html" title="contains light preferences like color,position,shadow...">TLight</a> *l);
<a name="l00402"></a>00402 
<a name="l00405"></a><a class="code" href="class_t_scene.html#afc3efd4114326fdfcdfd23df70246583">00405</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#afc3efd4114326fdfcdfd23df70246583" title="Set shadow parameters(shadow size and intensity) for selected light (by index) (see...">SetShadow</a>(GLint lightNum, GLint shadow_size = 2048, <span class="keywordtype">int</span> type = <a class="code" href="globals_8h.html#ad1b7e7fa524e4833bad682f41e1c68a5a072651f3f47e0c7f8d4ce21719f0a57c">SPOT</a>, 
<a name="l00406"></a>00406                    GLfloat _shadow_intensity = 0.5, <span class="keywordtype">bool</span> shadow = <span class="keyword">true</span>){
<a name="l00407"></a>00407         <a class="code" href="class_t_scene.html#af9127a45537c1ae0dc61f055de145c15">m_useShadows</a> = <span class="keyword">true</span>;
<a name="l00408"></a>00408         <span class="keywordflow">if</span>(lightNum &lt; 0 || (<span class="keywordtype">unsigned</span>)lightNum &gt; <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>.size()) 
<a name="l00409"></a>00409             cerr&lt;&lt;<span class="stringliteral">&quot;WARNING: no light with index &quot;</span>&lt;&lt;lightNum&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00410"></a>00410         <span class="keywordflow">else</span> 
<a name="l00411"></a>00411         {
<a name="l00412"></a>00412             <a class="code" href="class_t_scene.html#a0099fd546956bf36c69886975ce6609b" title="associative array with all lights">m_lights</a>[lightNum]-&gt;SetShadow(shadow_size,_shadow_intensity, type, shadow);
<a name="l00413"></a>00413             <a class="code" href="class_t_scene.html#a8ded9af1b75953a29095c70a973b30c9">m_shadow_textures</a>++;
<a name="l00414"></a>00414         }
<a name="l00415"></a>00415     }
<a name="l00416"></a>00416 
<a name="l00418"></a><a class="code" href="class_t_scene.html#a8878b2418a5489bae78622e71288b793">00418</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a8878b2418a5489bae78622e71288b793" title="Enable/disable shadow casting by selected object (by name) (see TObject::CastShadow()...">CastShadow</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *obj_name, <span class="keywordtype">bool</span> flag){ 
<a name="l00419"></a>00419         <span class="keywordflow">if</span>(<a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>.find(obj_name) == <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>.end()) 
<a name="l00420"></a>00420             cerr&lt;&lt;<span class="stringliteral">&quot;WARNING (cast shadow): no object with name&quot;</span>&lt;&lt;obj_name&lt;&lt;<span class="stringliteral">&quot;!\n&quot;</span>; 
<a name="l00421"></a>00421         <span class="keywordflow">else</span> 
<a name="l00422"></a>00422             <a class="code" href="class_t_scene.html#ad9c242ab1f7bfb9833ef0c4146d5f677" title="associative array with all objects">m_objects</a>[obj_name]-&gt;CastShadow(flag); 
<a name="l00423"></a>00423     } 
<a name="l00424"></a>00424 
<a name="l00426"></a><a class="code" href="class_t_scene.html#a151d4865f99f369a16caefb9dcaaa80f">00426</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a151d4865f99f369a16caefb9dcaaa80f" title="Enable/disable shadow receiving for selected material (by name) (see TMaterial::ReceiveShadow()...">ReceiveShadow</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *mat_name, <span class="keywordtype">bool</span> flag){ 
<a name="l00427"></a>00427         <span class="keywordflow">if</span>(<a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.find(mat_name) == <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>.end()) 
<a name="l00428"></a>00428             cerr&lt;&lt;<span class="stringliteral">&quot;WARNING (receive shadow): no material with name&quot;</span>&lt;&lt;mat_name&lt;&lt;<span class="stringliteral">&quot;!\n&quot;</span>; 
<a name="l00429"></a>00429         <span class="keywordflow">else</span> 
<a name="l00430"></a>00430             <a class="code" href="class_t_scene.html#a8d9c9d4931a8f2d540545f5d106b7460" title="associative array with all materials">m_materials</a>[mat_name]-&gt;ReceiveShadow(flag); 
<a name="l00431"></a>00431     }
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 
<a name="l00436"></a><a class="code" href="class_t_scene.html#af022c0b0ac3d7ce74a6034bca764a0fd">00436</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#af022c0b0ac3d7ce74a6034bca764a0fd" title="GLobally enable/disable shadows (for enable, shadows must be created for light that...">UseShadows</a>(<span class="keywordtype">bool</span> flag = <span class="keyword">true</span>){ 
<a name="l00437"></a>00437         <a class="code" href="class_t_scene.html#af9127a45537c1ae0dc61f055de145c15">m_useShadows</a> = flag; 
<a name="l00438"></a>00438     }
<a name="l00439"></a>00439 
<a name="l00440"></a>00440     <span class="comment">//IMPROVED DUAL-PARABOLOID SHADOWS SETTINGS</span>
<a name="l00441"></a>00441 
<a name="l00443"></a><a class="code" href="class_t_scene.html#a8a2c543a81f76a8f99e5510ef3b773f7">00443</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a8a2c543a81f76a8f99e5510ef3b773f7" title="Toggle dual-paraboloid shadow enhancements.">DPShadowEnhance</a>(<span class="keywordtype">bool</span> flag){
<a name="l00444"></a>00444         <a class="code" href="class_t_scene.html#a52bc2e66d0e82e66d25d31e8ddd848fa">m_dpshadow_enhance</a> = flag;
<a name="l00445"></a>00445         <span class="keywordflow">if</span>(!flag)
<a name="l00446"></a>00446         {
<a name="l00447"></a>00447             <a class="code" href="class_t_scene.html#affaf1c7e73abcc89118c5a439d9e45dc" title="settings for DPSM">m_dp_FOV</a> = 179.0f;
<a name="l00448"></a>00448             <a class="code" href="class_t_scene.html#a9258935d6441e202e127c39aa773662f">m_avg_depth</a> = 1000.0f;
<a name="l00449"></a>00449         }
<a name="l00450"></a>00450     }
<a name="l00451"></a>00451 
<a name="l00453"></a><a class="code" href="class_t_scene.html#ad132e8508f3bed1dbeb60b7b4db1dd7b">00453</a>     <span class="keywordtype">float</span> <a class="code" href="class_t_scene.html#ad132e8508f3bed1dbeb60b7b4db1dd7b" title="Get far point value.">DPGetFarPoint</a>(){
<a name="l00454"></a>00454         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#a9258935d6441e202e127c39aa773662f">m_avg_depth</a>;
<a name="l00455"></a>00455     }
<a name="l00457"></a><a class="code" href="class_t_scene.html#acfcff66362dfcef719fd8c9eb57e4ebc">00457</a>     glm::vec3 <a class="code" href="class_t_scene.html#acfcff66362dfcef719fd8c9eb57e4ebc" title="Get average normal.">DPGetAvgNormal</a>(){
<a name="l00458"></a>00458         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#a875f1f2fbb09a035c12f0e6428e8cd65">m_avg_normal</a>;
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460 
<a name="l00462"></a><a class="code" href="class_t_scene.html#aa74266bc5d69df3581f494cc0d703a29">00462</a>     <span class="keywordtype">float</span> <a class="code" href="class_t_scene.html#aa74266bc5d69df3581f494cc0d703a29" title="Get actual shadow FOV (front paraboloid).">DPGetFOV</a>(){
<a name="l00463"></a>00463         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#affaf1c7e73abcc89118c5a439d9e45dc" title="settings for DPSM">m_dp_FOV</a>;
<a name="l00464"></a>00464     }
<a name="l00465"></a>00465 
<a name="l00467"></a><a class="code" href="class_t_scene.html#a15ec53d2bccad1b8f5fb28bc8d231d57">00467</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a15ec53d2bccad1b8f5fb28bc8d231d57" title="toggle tessellation in paraboloid projection">DPTessellation</a>(<span class="keywordtype">bool</span> flag){
<a name="l00468"></a>00468         <span class="keywordflow">if</span>(flag &amp;&amp; !GLEW_ARB_gpu_shader5)
<a name="l00469"></a>00469         {
<a name="l00470"></a>00470             cout&lt;&lt;<span class="stringliteral">&quot;OpenGL 4 not supported. Cannot enable tessellation :(\n&quot;</span>;
<a name="l00471"></a>00471             flag = <span class="keyword">false</span>;
<a name="l00472"></a>00472         }
<a name="l00473"></a>00473         <a class="code" href="class_t_scene.html#ac50966b27e0d12f04aa87feda3467f7c">m_dpshadow_tess</a> = flag;
<a name="l00474"></a>00474     }
<a name="l00475"></a>00475 
<a name="l00477"></a><a class="code" href="class_t_scene.html#a2b80fe5c81d9c94b6642b966c8c42ed9">00477</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a2b80fe5c81d9c94b6642b966c8c42ed9" title="Toggle shadow map drawing.">DPDrawSM</a>(<span class="keywordtype">bool</span> flag){
<a name="l00478"></a>00478         <a class="code" href="class_t_scene.html#a29fe9fbe40be1e7b2db162ce403ad496">m_draw_shadow_map</a> = flag;
<a name="l00479"></a>00479     }
<a name="l00480"></a>00480 
<a name="l00482"></a>00482 
<a name="l00483"></a>00483     <span class="comment">//prepare screen quad</span>
<a name="l00484"></a>00484     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a064c847be3f1f51794b908c8a6c0a0a5" title="Create screen quad.">AddScreenQuad</a>();
<a name="l00485"></a>00485     <span class="comment">//create single data texture</span>
<a name="l00486"></a>00486     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ac1206009d47b590fdd5c8ac2c799ba99" title="Create single render texture.">CreateDataTexture</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="demo_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, <span class="keywordtype">int</span> resX, <span class="keywordtype">int</span> resY, GLint tex_format, GLenum tex_type, GLenum tex_target = GL_TEXTURE_2D);
<a name="l00487"></a>00487     <span class="comment">//prepare texture to render into for HDR rendering</span>
<a name="l00488"></a>00488     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a7c402f4c95ea998a4d90995e6c566e63" title="Create render target using framebuffer and attached texture.">CreateHDRRenderTarget</a>(<span class="keywordtype">int</span> resX = -1, <span class="keywordtype">int</span> resY = -1, GLint tex_format = GL_RGBA16F, GLenum tex_type = GL_FLOAT, <span class="keywordtype">bool</span> normal_buffer = <span class="keyword">false</span>);
<a name="l00489"></a>00489     <span class="comment">//resize render target textures</span>
<a name="l00490"></a>00490     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a7c23a1b00965c3430043ce56c29e838f" title="Resize render target textures.">ResizeHDRRenderTarget</a>(<span class="keywordtype">int</span> resX, <span class="keywordtype">int</span> resY, GLint tex_format = GL_RGBA16F, GLenum tex_type = GL_FLOAT);
<a name="l00491"></a>00491     <span class="comment">//check framebuffer status</span>
<a name="l00492"></a>00492     <span class="keywordtype">bool</span> <a class="code" href="class_t_scene.html#aa5f4f3e084775f2ff85cab2a757d36e3" title="Check framebuffer status.">CheckFBO</a>();
<a name="l00493"></a>00493     <span class="comment">//render screen quad with attached shader</span>
<a name="l00494"></a>00494     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a0b13869f8bd528c6edd24bf2c84aae7f" title="Render screen quad with attached material.">RenderPass</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* material);
<a name="l00495"></a>00495     <span class="comment">//render small quad over scene (to visualize some buffers etc)</span>
<a name="l00496"></a>00496     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ad6aef857ac1efff80a4b7c0e8378bd4b" title="Render small quad over scene with attached material (to visualize buffers etc...)...">RenderSmallQuad</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* material, <span class="keywordtype">float</span> offset_x, <span class="keywordtype">float</span> offset_y, <span class="keywordtype">float</span> size);
<a name="l00498"></a><a class="code" href="class_t_scene.html#ad4de1526f94f1f1e436353bb9029e553">00498</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ad4de1526f94f1f1e436353bb9029e553" title="toggle use of HDR">UseHDR</a>(<span class="keywordtype">bool</span> flag = <span class="keyword">true</span>){ 
<a name="l00499"></a>00499         <a class="code" href="class_t_scene.html#ae29ca11435acf4c416278f409c2f0ca1" title="shall we use HDR, SSAO or shadows?">m_useHDR</a> = flag; 
<a name="l00500"></a>00500     }
<a name="l00502"></a><a class="code" href="class_t_scene.html#ac3c01cf5f75e06d1a06b65d9a769f188">00502</a>     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ac3c01cf5f75e06d1a06b65d9a769f188" title="toggle use of SSAO">UseSSAO</a>(<span class="keywordtype">bool</span> flag = <span class="keyword">true</span>){ 
<a name="l00503"></a>00503         <a class="code" href="class_t_scene.html#a258d8ec26e1850f49ff71a139c7c4216">m_useSSAO</a> = flag; 
<a name="l00504"></a>00504         <a class="code" href="class_t_scene.html#aee8df7b5db5f3fd21b55d97cfa6a4d7b">m_useNormalBuffer</a> = flag;        
<a name="l00505"></a>00505     }
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 
<a name="l00509"></a>00509 
<a name="l00510"></a>00510     <span class="comment">//Draw text on screen</span>
<a name="l00511"></a>00511     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#ae106514148da2e21acb0e0ee7fa42210" title="Print 2D texture font on screen.">DrawScreenText</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="demo_8cpp.html#aab0a66bd50a2d469eea909d667b556ab">s</a>, <span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> size = 1.0, <span class="keywordtype">bool</span> center = <span class="keyword">true</span>);
<a name="l00512"></a>00512     <span class="keywordtype">void</span> <a class="code" href="class_t_scene.html#a3916e88a3cc7d63c2ad4c284842f9014" title="Create display lists for all characters(256) in font. Font is read from file.">BuildFont</a>();
<a name="l00513"></a>00513 
<a name="l00515"></a>00515 
<a name="l00517"></a><a class="code" href="class_t_scene.html#a9d964b628104c753e7f3940184f5155e">00517</a>     <span class="keywordtype">int</span> <a class="code" href="class_t_scene.html#a9d964b628104c753e7f3940184f5155e" title="Get screen width.">GetResX</a>(){
<a name="l00518"></a>00518         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#a3f9117f3ae307e7d63a754ea10c33c46" title="screen resolution">m_resx</a>; 
<a name="l00519"></a>00519     }
<a name="l00521"></a><a class="code" href="class_t_scene.html#a972ab36eaf8c9029399f93f687a3b95b">00521</a>     <span class="keywordtype">int</span> <a class="code" href="class_t_scene.html#a972ab36eaf8c9029399f93f687a3b95b" title="Get screen height.">GetResY</a>(){ 
<a name="l00522"></a>00522         <span class="keywordflow">return</span> <a class="code" href="class_t_scene.html#a3cd097f1e85a8d1d1e2a13e90e616342">m_resy</a>; 
<a name="l00523"></a>00523     }
<a name="l00524"></a>00524 };
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 
<a name="l00527"></a>00527 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
